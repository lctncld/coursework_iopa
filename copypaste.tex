%!TEX root = main.tex

\newpage
\section{Задание}

Синтезировать 4-разрядный ОА, реализующий две операции --- арифметическую и логическую, в соответствии с заданным вариантом (Таблица \ref{table:task}). Работу ОА промоделировать, используя САПР <<Альтера>> Max+plus II.

\begin{table}[H]
	\centering
	\caption{Операции, реализуемые ОА}
	\label{table:task}
	\begin{tabular}{| l | l | l | p{2.2cm} | p{2.2cm} | c | c | c | c | c |} \hline
		\multirow{2}{2cm}{Вариант} & \multirow{2}{2cm}{Операция} & \multirow{2}{2cm}{Код} & \multirow{2}{2.2cm}{Элементы памяти ОА1} & \multirow{2}{2.2cm}{Элементы памяти ОА2} & \multicolumn{5}{c|}{Признаки} \\ \cline{6-10}
		& & & & & S & Z & C' & P & C \\ \hline 
		\multirow{2}{2cm}{2в, 1} & $A \leftarrow A - 1$ & 8421+3 & JK & \multirow{2}{2.2cm}{DC} & + & + & + & + & - \\ \cline{2-4} \cline{6-10}

		& $A \leftarrow A \& B$ & двоичный & JK & & + & + & 0 & + & 0 \\ \hline 
	\end{tabular}
\end{table}


\newpage
\section{Структура ОА}

На этапе структурного синтеза ОА представляют в виде двух частей --- памяти и комбинационной схемы КС (Рисунок \ref{figure:oooa}). КС служит для преобразования входных сигналов Х и информации о состоянии устройства (А) в выходные сигналы Y и сигналы возбуждения элементов памяти U.

\begin{figure}[H]
	\includegraphics[scale=0.6]{images/2.png}
	\caption{Обобщенная структура ОА}
	\label{figure:oooa}
\end{figure}

Поведение структуры (Рисунок \ref{figure:oooa}) описывается четырьмя группами различных сигналов:

$X$ --- входное слово,

$Y = (X,A)$ --- выходное слово,

$U = \psi(X,A)$ --- слово (функция), обеспечивающее порядок смены состояний автомата

$A$ --- слово, характеризующее состояние автомата.

Внутреннее состояние автомата $А$ определяется состоянием триггеров $a_r \in \{0, 1\}$  и описывается словом состояния $A = (a_1, a_2, a_3, ..., a_i, ... a_r), r = \oline{1,R}$. Множество слов $A$ определяет объем памяти ОА.

Синтезируемый ОА является 4-х разрядным и формирует слово состояния $A = a_3a_2a_1a_0$ .


\newpage
\section{Синтез ОА}

Задача синтеза ОА сводится к:
\begin{itemize}
	\item выбору типа элементов памяти (триггеров), который задан заранее (в данной курсовой работе --- JK-триггеры);
	\item разработке КС, для чего необходимо сформировать систему переключательных функций, описывающую ее поведение:

	$\begin{cases}
			U = \psi(X, A), \\ Y = \lambda(X, A)
	\end{cases}$ (1)
	\item реализации системы ПФ (1) на заданной элементной базе (в данной курсовой работе используется элементная база САПР <<Альтера>> Max+plus II).

\end{itemize}

В случае, если автомат оказывается сложным, задачу синтеза ОА упрощают, декомпозируя (разделяя) его на более простые автоматы ОА$_1$ и ОА$_2$ (Рисунок \ref{figure:decomp}) с одинаковой структурой (Рисунок \ref{figure:srtuct}).

\begin{figure}[H]
	\includegraphics[scale=0.6]{images/3.png}
	\caption{Декомпозиция ОА}
	\label{figure:decomp}
\end{figure}

\begin{figure}[H]
	\includegraphics[scale=0.6]{images/4.png}
	\caption{Структурное представление ОА1 и ОА2}
	\label{figure:srtuct}
\end{figure}

Арифметико-логический автомат ОА$_1$ формирует слово результата операции $А$ и сигналы $f_S$, $f_Z$, $f_C'$, $f_P$, $f_C$ --- логические функции признаков (ЛФП), относящиеся к выходным сигналам $Y=\lambda(X, A)$, на основе которых ОА$_2$ формирует уже сами признаки --- слово $F = (S, Z, P, C, C')$ в соответствии с логикой признаков, которая задается таблично (Таблица \ref{table:task}) для каждой отдельной операции.

Операции, реализуемые ОА (Рисунок \ref{figure:decomp}), инициализируются управляющими сигналами $yi$. В данной работе используется только один управляющий сигнал $y$. Если этот сигнал принимает значение $0$, то выполняется арифметическая операция, иначе --- логическая.

\subsection{Синтез ОА${}_1$}


ОА$_1$ можно рассматривать как многооперационный автомат, способный реализовать не одну, а несколько операций. Синтез автомата ОА$_1$ разделяется на синтез автоматов ОА$^{(0)}_{1}$ и ОА$^{(1)}_{1}$ с памятью на  JK-триггерах, реализующих соответственно: 

\begin{itemize}
	\item операцию декремента $A \leftarrow A-1$ в коде 8421+3, инициируемую сигналом $y_0$.
	\item операцию логического умножения $A \leftarrow A \& B$ , инициируемую сигналом $y_1$.

\end{itemize}

Абстрактное представление ОА$_1$ изображено на рисунке \ref{figure:abs_oa1}.

\begin{figure}[H]
	\begin{subfigure}[b]{0.3\textwidth}
		\includegraphics[scale=0.7]{images/abs10.png}
	\end{subfigure}
	\qquad
	\begin{subfigure}[b]{0.3\textwidth}
		\includegraphics[scale=0.7]{images/abs11.png}
	\end{subfigure}
	\caption{Абстрактное представление ОА1}
	\label{figure:abs_oa1}
\end{figure}

ОА$^{(0)}_{1}$ реализует операцию над одним словом $А$ с установкой результата, поэтому ОА не декомпозируется, и синтезируется как единый 4-х разрядный ОЭ.

ОА$^{(1)}_{1}$ реализует операцию над двумя 4-х разрядными словами $А$ и $В$ с установкой результата. Сигналы возбуждения и выходов являются функциями восьми аргументов. При рассмотрении такого автомата как единого ОЭ синтез значительно усложнится (КТ будет содержать $256 = 2^8$ наборов), поэтому ОА$^{(1)}_{1}$ декомпозируется и синтезируется как композиция одноразрядных ОЭ.


\subsubsection{Синтез ОА$^{(0)}_{1}$}

Автомат ОА$^{(0)}_{1}$ описывается функциями переходов $A(t+1) = \delta^0(A(t))=\delta^0(a_3,a_2,a_1,a_0)$ и выходов $f^0_{G} = f^0_{G}(A(t)) = f^0_{G}(a_3,a_2,a_1,a_0)$, $G = S, Z, C', P, C$, которые  определяют структуру совмещенной кодированной таблицы (Таблица 2). Каждому значению $A(t)$ ставится в соответствие двоичный вектор следующего состояния автомата $A(t+1) = a^*_3,a^*_2,a^*_1,a^*_0$ как результат функции перехода $\delta^0$ операции $y_0: (A \leftarrow A-1)$.

\begin{landscape}
\begin{table}[H]
	\centering
	\caption{Совмещенная КТ для ОА$^{(0)}_{1}$}
	\label{table:OA10f}
	\begin{tabular}{|l|*{22}{c|}{r|}} \hline
		\multirow{3}{0.5cm}{N}
		& \multicolumn{4}{p{2cm}|}{Текущее состояние ОА$^{(0)}_{1}$}
		& \multicolumn{4}{p{2cm}|}{Следующее состояние ОА$^{(0)}_{1}$}
		& \multicolumn{8}{c|}{ФВ $T^0_j$}
		& \multicolumn{5}{c|}{\multirow{2}{2cm}{ЛФП}} \\ \cline{2-17}

		& \multicolumn{4}{c|}{$A(t)$}
		& \multicolumn{4}{c|}{$A(t+1)$}
		& \multicolumn{2}{c|}{$T_3$} 
		& \multicolumn{2}{c|}{$T_2$} 
		& \multicolumn{2}{c|}{$T_1$} 
		& \multicolumn{2}{c|}{$T_0$}
		& \multicolumn{5}{c|}{} \\  \cline{2-22}

		& $a_3$ & $a_2$ & $a_1$ & $a_0$
		& $a^*_3$ & $a^*_2$ & $a^*_1$ & $a^*_0$
		& $J^{(0)}_{3}$ & $K^{(0)}_{3}$ & $J^{(0)}_{2}$ & $K^{(0)}_{2}$  
		& $J^{(0)}_{1}$ & $K^{(0)}_{1}$ & $J^{(0)}_{0}$ & $K^{(0)}_{0}$
		& $f^{(0)}_{S}$ & $f^{(0)}_{Z}$ & $f^{(0)}_{C'}$ & $f^{(0)}_{P}$ & $f^{(0)}_{C}$ \\ \hline

0 & 	0 & 0 & 1 & 1 & 	1 & 1 & 0 & 0 & 	1 & x & 1 & x & x & 1 & x & 1 & 	1 & 0 & 0 & 1 & 0 \\ \hline
1 & 	1 & 1 & 0 & 0 & 	1 & 0 & 1 & 1 & 	x & 0 & x & 1 & 1 & x & 1 & x & 	1 & 0 & 1 & 0 & 0 \\ \hline
2 & 	1 & 0 & 1 & 1 & 	1 & 0 & 1 & 0 & 	x & 0 & 0 & x & x & 0 & x & 1 & 	1 & 0 & 0 & 1 & 0 \\ \hline
3 & 	1 & 0 & 1 & 0 & 	1 & 0 & 0 & 1 & 	x & 0 & 0 & x & x & 1 & 1 & x & 	1 & 0 & 0 & 1 & 0 \\ \hline
4 & 	1 & 0 & 0 & 1 & 	1 & 0 & 0 & 0 & 	x & 0 & 0 & x & 0 & x & x & 1 & 	1 & 0 & 0 & 0 & 0 \\ \hline
5 & 	1 & 0 & 0 & 0 & 	0 & 1 & 1 & 1 & 	x & 1 & 1 & x & 1 & x & 1 & x & 	0 & 0 & 1 & 0 & 0 \\ \hline
6 & 	0 & 1 & 1 & 1 & 	0 & 1 & 1 & 0 & 	0 & x & x & 0 & x & 0 & x & 1 & 	0 & 0 & 0 & 1 & 0 \\ \hline
7 & 	0 & 1 & 1 & 0 & 	0 & 1 & 0 & 1 & 	0 & x & x & 0 & x & 1 & 1 & x & 	0 & 0 & 0 & 1 & 0 \\ \hline
8 & 	0 & 1 & 0 & 1 & 	0 & 1 & 0 & 0 & 	0 & x & x & 0 & 0 & x & x & 1 & 	0 & 0 & 0 & 0 & 0 \\ \hline
9 & 	0 & 1 & 0 & 0 & 	0 & 0 & 1 & 1 & 	0 & x & x & 1 & 1 & x & 1 & x & 	0 & 1 & 1 & 1 & 0 \\ \hline
		

	\end{tabular}
\end{table}
\end{landscape}

Для каждого из триггеров $T_3 \div T_0$ на основе смены их состояний $a_i \rightarrow a^{*}_i, i=\oline{0,3}$ в соответствии с матрицей переходов (таблица \ref{table:JK_SMW}) формируются двоичные сигналы функций возбуждения (ФВ) $T^0_j, j=\oline{0,3}$, под действием которых они меняют свои состояния. В соответствии с таблицей \ref{table:OA10f} при выполнении операции со словом $A$ устанавливаются логические функции признаков (ЛФП) $f_S$, $f_Z$, $f_P$, $f_C'$. Признак $f_C$ остаётся неизменным.

Признаки:
\begin{itemize}
	\item fS --- фиксирует знаковый бит результата,
	\item fZ --- фиксирует нулевой результат,
	\item fP --- фиксирует четное число единиц результата,
	\item fC --- фиксирует перенос (заем) из старшего бита результата,
	\item fC’---  фиксирует вспомогательный перенос (заем) из бита $а_2$ результата.
\end{itemize}

\begin{table}[H]
	\centering
	\caption{Матрица переходов JK-триггера}
	\label{table:JK_SMW}
	\begin{tabular}{| l | p{1cm} | p{1cm} |} \hline
		\multirow{2}{*}{Переход} & \multicolumn{2}{c|}{Вход триггера}\\ \cline{2-3}
		& J & K \\ \hline
		$0 \rightarrow 0$ & 	$0$ & $x$ \\ \hline
		$0 \rightarrow 1$ & 	$1$ & $x$ \\ \hline
		$1 \rightarrow 0$ & 	$x$ & $1$ \\ \hline
		$1 \rightarrow 1$ & 	$x$ & $0$ \\ \hline
	\end{tabular}
\end{table}

Полученные функции  $J^{(0)}_{3}$, $K^{(0)}_{3}$, $J^{(0)}_{2}$, $K^{(0)}_{2}$, $J^{(0)}_{1}$, $K^{(0)}_{1}$, $J^{(0)}_{0}$, $K^{(0)}_{0}$, $f^{(0)}_{S}$, $f^{(0)}_{Z}$, $f^{(0)}_{C'}$, $f^{(0)}_{P}$, $f^{(0)}_{C}$  заносятся на карты Карно для минимизации (Рисунок \ref{figure:oa10_min_trig}, \ref{figure:oa10_min_flags}).

\input{karnaught_oa10.tex}

В результате минимизации получается система ПФ, представленных в МДНФ:

$J^{(0)}_{3} = \oline{a_2}$

$K^{(0)}_{3} = \oline{a_2} \cdot \oline{a_1} \cdot \oline{a_0}$

$J^{(0)}_{2} = \oline{a_3} \vee \oline{a_1} \cdot \oline{a_0}$

$K^{(0)}_{2} = \oline{a_1} \cdot \oline{a_0}$

$J^{(0)}_{1} = \oline{a_0}$

$K^{(0)}_{1} = \oline{a_0} \vee \oline{a_3} \cdot \oline{a_2}$

$J^{(0)}_{0} = 1$

$K^{(0)}_{0} = 1$

$f^{(0)}_{S} = a_3 \cdot a_2 \vee \oline{a_2} \cdot a_1 \vee a_3 \cdot a_0 $

$f^{(0)}_{Z} = \oline{a_3} \cdot \oline{a_1} \cdot \oline{a_0}$

$f^{(0)}_{C'} = \oline{a_1} \cdot \oline{a_0}$

$f^{(0)}_{P} = a_1 \vee \oline{a_3} \cdot \oline{a_0}$

$f^{(0)}_{C} = 0$


\subsubsection{Синтез ОА$^{(1)}_{1}$}

\input{karnaught_oa11.tex}

\subsubsection{Объединенные ФВ И ЛФП ОА${}_1$}

\subsection{Синтез ОА${}_2$}
